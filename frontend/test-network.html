<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Status Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .status-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .online { color: #10b981; }
        .offline { color: #ef4444; }
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #2563eb;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üåê Network Status Test</h1>
    
    <div class="status-card">
        <h2>Current Status</h2>
        <p>Network: <span id="network-status" class="online">üü¢ Online</span></p>
        <p>Last Update: <span id="last-update">-</span></p>
        <p>Error Count: <span id="error-count">0</span></p>
    </div>

    <div class="status-card">
        <h2>Test Controls</h2>
        <button class="test-button" onclick="simulateOffline()">Simulate Offline</button>
        <button class="test-button" onclick="simulateOnline()">Simulate Online</button>
        <button class="test-button" onclick="clearLog()">Clear Log</button>
    </div>

    <div class="status-card">
        <h2>Event Log</h2>
        <div id="log" class="log"></div>
    </div>

    <script>
        let errorCount = 0;
        const maxRetries = 3;

        function updateStatus() {
            const isOnline = navigator.onLine;
            const statusElement = document.getElementById('network-status');
            const lastUpdateElement = document.getElementById('last-update');
            const errorCountElement = document.getElementById('error-count');

            if (isOnline) {
                statusElement.textContent = 'üü¢ Online';
                statusElement.className = 'online';
            } else {
                statusElement.textContent = 'üî¥ Offline';
                statusElement.className = 'offline';
            }

            lastUpdateElement.textContent = new Date().toLocaleTimeString();
            errorCountElement.textContent = errorCount;
        }

        function log(message) {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function simulateOffline() {
            log('‚ö†Ô∏è Simulating offline state...');
            errorCount++;
            
            if (errorCount >= maxRetries) {
                log('‚ùå Too many errors - would stop tracking');
            } else {
                log('‚ö†Ô∏è Network issue - keeping last known location');
            }
        }

        function simulateOnline() {
            log('üéâ Simulating online state...');
            errorCount = 0;
            log('‚úÖ Connection restored - resuming normal operation');
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        // Event listeners
        window.addEventListener('online', () => {
            log('üéâ Network connection restored');
            errorCount = 0;
            updateStatus();
        });

        window.addEventListener('offline', () => {
            log('‚ö†Ô∏è Network connection lost');
            updateStatus();
        });

        // Initial setup
        updateStatus();
        log('üì± Network status test initialized');

        // Update status every second
        setInterval(updateStatus, 1000);
    </script>
</body>
</html>
